<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no">
    <title>CORK Admin Template - Contact List Application</title>
    <link rel="icon" type="image/x-icon" href="publicassets/img/favicon.ico"/>
    <!-- BEGIN GLOBAL MANDATORY STYLES -->
    <link href="https://fonts.googleapis.com/css?family=Quicksand:400,500,600,700&display=swap" rel="stylesheet">
    <link href="public/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <link href="public/assets/css/plugins.css" rel="stylesheet" type="text/css"/>
    <!-- BEGIN PAGE LEVEL STYLES -->
    <link href="/public/plugins/sweetalerts/sweetalert2.min.css" rel="stylesheet" type="text/css"/>
    <link href="/public/plugins/sweetalerts/sweetalert.css" rel="stylesheet" type="text/css"/>
    <link href="/public/assets/css/components/custom-sweetalert.css" rel="stylesheet" type="text/css"/>
    <!-- END GLOBAL MANDATORY STYLES -->

    <!-- BEGIN PAGE LEVEL STYLES -->
    <link rel="stylesheet" type="text/css" href="public/assets/css/forms/theme-checkbox-radio.css">
    <link href="public/plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet" type="text/css"/>
    <link href="public/assets/css/apps/contacts.css" rel="stylesheet" type="text/css"/>
    <!-- END PAGE LEVEL STYLES -->
</head>
<body class="alt-menu sidebar-noneoverflow">

<!--  BEGIN MAIN CONTAINER  -->
<div class="main-container sidebar-closed sbar-open" id="container">

    <!--  BEGIN CONTENT AREA  -->
    <div id="content" class="main-content">
        <div class="layout-px-spacing">
            <div class="row layout-spacing layout-top-spacing" id="cancel-row">
                <div class="col-lg-12">
                    <div class="widget-content searchable-container list">
                        <div class="row">
                            <div class="col-xl-4 col-lg-5 col-md-5 col-sm-7 filtered-list-search layout-spacing align-self-center">
                                <form class="form-inline my-2 my-lg-0">
                                    <div class="">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-search">
                                            <circle cx="11" cy="11" r="8"></circle>
                                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                                        </svg>
                                        <input type="text" class="form-control product-search" id="input-search"
                                               placeholder="搜索...">
                                    </div>
                                </form>
                            </div>

                        </div>

                        <div class="searchable-items list">
                            <div class="items items-header-section">
                                <div class="item-content">
                                    <div class="">
                                        <h4>任务名称</h4>
                                    </div>
                                    <div class="user-email">
                                        <h4>任务状态</h4>
                                    </div>
                                    <div class="user-email">
                                        <h4>Cron</h4>
                                    </div>
                                    <div class="user-location">
                                        <h4 style="margin-left: 0;">开始时间</h4>
                                    </div>
                                    <div class="user-phone">
                                        <h4 style="margin-left: 3px;">最后一次运行时间</h4>
                                    </div>
<!--                                    <div class="user-phone">-->
<!--                                        <h4 style="margin-left: 3px;">操作</h4>-->
<!--                                    </div>-->
                                </div>
                            </div>
                            <div class="items">
                                <div class="items items-header-section">
                                    <div class="item-content">
                                        <div class="">
                                            <h4>奖励发放</h4>
                                        </div>
                                        <div class="user-email">
                                            {% if schedule.status==true %}
                                            <span class="badge badge-success">运行中</span>
                                            {% else %}
                                            <span class="badge badge-warning">已停止</span>
                                            {% endif %}
                                        </div>
                                        <div class="user-email">
                                            <h4>{{jobs.cron}}</h4>
                                        </div>
                                        <div class="user-location">
                                            <h4 style="margin-left: 0;">
                                                {{startTime}}
                                            </h4>
                                        </div>
                                        <div class="user-phone">
                                            <h4 style="margin-left: 3px;">
                                                {{latestRunTime}}
                                            </h4>
                                        </div>
                                        <div class="user-phone">
<!--                                            <button class="btn btn-outline-info btn-sm"-->
<!--                                                    onclick='start()'>-->
<!--                                                启动-->
<!--                                            </button>-->
<!--                                            <button class="btn btn-outline-warning btn-sm"-->
<!--                                                    onclick='stop()'>-->
<!--                                                停止-->
<!--                                            </button>-->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--  END CONTENT AREA  -->

</div>
<!-- END MAIN CONTAINER -->

<!-- BEGIN GLOBAL MANDATORY SCRIPTS -->
<script src="public/assets/js/libs/jquery-3.1.1.min.js"></script>
<script src="public/bootstrap/js/popper.min.js"></script>
<script src="public/bootstrap/js/bootstrap.min.js"></script>
<script src="public/plugins/perfect-scrollbar/perfect-scrollbar.min.js"></script>
<script src="public/assets/js/app.js"></script>
<script src="/public/plugins/sweetalerts/sweetalert2.min.js"></script>
<script src="/public/plugins/sweetalerts/custom-sweetalert.js"></script>
<script>
    $(document).ready(function () {
        App.init();
    });


    function stop() {
        $.ajax({
            method: 'post',
            url: "/schedule/stop",
            success: function (result) {
                if (result.code == 200) {
                    const toast = swal.mixin({
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: 5000,
                        padding: '2em'
                    });
                    toast({
                        type: 'success',
                        title: '停止完成',
                        padding: '2em',
                    })
                    setTimeout(function () {
                        location.reload();
                    }, 3000)
                }
            }
        });
    }

    function start() {
        $.ajax({
            method: 'post',
            url: "/schedule/start",
            success: function (result) {
                if (result.code == 200) {
                    const toast = swal.mixin({
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: 5000,
                        padding: '2em'
                    });
                    toast({
                        type: 'success',
                        title: '启动完成',
                        padding: '2em',
                    })
                    setTimeout(function () {
                        location.reload();
                    }, 3000)
                }
            }
        });
    }
</script>
<script src="public/assets/js/custom.js"></script>
<!-- END GLOBAL MANDATORY SCRIPTS -->
<script src="public/plugins/jquery-ui/jquery-ui.min.js"></script>
<script src="public/assets/js/apps/contact.js"></script>
</body>
</html>